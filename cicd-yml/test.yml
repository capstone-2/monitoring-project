monitoring-testing-job:
  stage: test
  variables:
    GIT_STRATEGY: none
  script:
    - echo $JOB_START
    - hostname -I
    - cd cloud-monitoring
    - ls -al
    - cat README.md
    - echo $JOB_END
  only:
    - dev
  tags:
    - monitoring-cicd

monitoring-test-ok:
  stage: test
  variables:
    GIT_STRATEGY: none
  script:
    - echo
    - |
     curl --request POST --header "PRIVATE-TOKEN: $GITLAB_API_TOKEN" \
      --form "source_branch=dev" \
      --form "target_branch=main" \
      --form "title=CICD Merge Request test" \
      http://10.99.2.66:19494/api/v4/projects/$CI_PROJECT_ID/merge_requests
  when: manual
  needs:
    - job: monitoring-testing-job
      optional: false
  only:
    - dev
  tags:
    - monitoring-cicd